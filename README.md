# 35_diff_service

[TODO]


# Project Goals

The code is written for educational purposes. Training course for web-developers - [DEVMAN.org](https://devman.org)

Тебе приходилось делать git diff? Вот теперь тебе надо сделать сервис, который будет делать диф для юридических документов, свёрстанных в html (не спрашивай, почему так сложилось).

Смысл в том, что сотрудники заказчика отдают договор своим коллегам, чтобы те вписали туда свои позывные и хотят быть уверены, что помимо этого туда не было добавлено что-нибудь ещё. А если было добавлено – согласовать это.

Для этого им нужен сервис: загружаешь в него старую и новую версию и видишь диф как в Пайчарме: красным подсвечено удалённое, зелёным – добавленное, жёлтым – то, что переместилось из одной части документа в другую без изменений.

Сервис будет состоять из двух частей: АПИ и фронта, которые его использует.

АПИ состоит из одной ручки и принимает POST-запрос с телом в формате json вида:

    "doc1": "... текст документа 1",
    "doc2": "... текст документа 2",
    "config": {  // все поля конфига и сам конфиг – необязательный
        "add_class": "green",
        "add_element": "span",
        "remove_class": "red",
        "remove_element": "span",
        "moved_class": "yellow",
        "moved_element": "span",
    }
}

Если первый документ такой:

<ul>
    <li>Автор: Григорьев П.А.</li>
    <li>Сумма: 126000 руб.</li>
    <li>Дата: 26.12.14</li>
</ul>

а второй такой:

<ul>
    <li>Сумма: 126000 руб.</li>
    <li>Автор: Петров Г.Е.</li>
    <li>Дата: 26.12.14</li>
</ul>

то результат может выглядеть так:

<ul>
    <span class="yellow"><li>Сумма: 126000 руб.</li></span>
    <li><span class="red">Автор: Петров Г.Е.</span><span class="green">Автор: Григорьев П.А.</span></li>
    <span class="red"><li>Сумма: 126000 руб.</li></span>
    <li>Дата: 26.12.14</li>
</ul>

Ещё заказчик сказал, что у него есть библиотека, которая умеет делать диф для html, но не умеет детектить перемещение элементов. Мол, "да тут фигня, её надо слегка допилить, обернуть в апишку и накидать фронтенд на бутстрапе, работы-то на полдня".

Рекомендации:

    diff.py для получения diff у html-документов;
    flask для API;
    Bootstrap для фронтенда (загрузить два файла, увидеть результат);
    unittest для тестирования диффера при различном html.

